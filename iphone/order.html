<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>KLANmart - order</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../lib/jquery.mobile-1.4.5.min.css" />
    <link rel="stylesheet" href="../style/myOrders.css" />
    <script src="../lib/jquery-1.11.1.min.js"></script>
    <script src="../lib/jquery.mobile-1.4.5.min.js"></script>
    <script src="https://kit.fontawesome.com/2d990cff29.js" crossorigin="anonymous"></script>
    <script src="../js/common.js"></script>

    <script>
        window.onload = function () {
            var loggedUser = sessionStorage.getItem("logged_user");
            var myJson = JSON.parse(loggedUser);
            $(document).ready(function () {
                $.ajax({
                    url: "http://localhost:9002/KLANmart/orders/" + myJson.user_id
                }).then(function (data) {
                    console.log(data.result);
                    for (let i = 0; i < data.result.length; i++) {

                        if (data.result[i].order_status !== 'cart') {
                            let favouriteRow = document.createElement('div');
                            let favouriteItems = document.getElementsByClassName('f-main-content')[0];
                            console.log(favouriteItems);
                            let firstImageURL = JSON.parse(data.result[i].images)[0];
                            console.log(firstImageURL);
                            var favouriteContents = `
                    <div class="post" onclick="goToFeedback()">
                        <img alt="product image" src=${firstImageURL} class="post-image">
                        <div class="post-preview">
                            <p class="prodName">${data.result[i].product_name}</p>
                            <div class="divContainer">
                            <span id="labelStore"><i class="fas fa-store-alt"></i></span>
                            <span class="store-detail">${data.result[i].store_name}</span>
                            </div>
                            <div class="divContainer">
                            <span class="orderStatusLbl"> Status:</span>
                            <span class="orderStatus"> ${data.result[i].order_status}</span></div>
                            <p class="orderStatusLbl date-order"><i class="far fa-calendar-alt"></i>  ${data.result[i].order_time}</p>
                        </div>
                    </div>`;
                            favouriteRow.innerHTML = favouriteContents;
                            favouriteItems.append(favouriteRow);
                        }
                    }
                });
            });
        }

    </script>

    <style>

    </style>
</head>

<body>
    <div data-role="header" data-position="fixed" class="header-bar">
        <i onclick="profile()" class="fas fa-chevron-left back-icon"></i>
        <h1 class="page-detail">My Orders</h1>
    </div>

    <div data-role="content" data-theme="a">
        <div id="if_logged_favourite">
            <div class="content clearfix">
                <div class="f-main-content">
                    <!--This is the main content. List appends here-->
                </div>
            </div>
        </div>
    </div>
</body>

</html>